# Домашнее задание к занятию 6.1. «Типы и структура СУБД»

## Введение

Перед выполнением задания вы можете ознакомиться с [дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/virt-11/additional).

## Задание 1

*Архитектор ПО решил проконсультироваться у вас, какой тип БД лучше выбрать для хранения определённых данных.*

*Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД*:

>электронные чеки в json-виде

**Можно использовать MongoDB, документно-ориентированная БД позволяет хранить и управлять иерархически организованными структурами данных. Данные в документах хранятся в JSON подобной структуре, состоящей из ключей и значений, в двоичном формате BSON**. 

>склады и автомобильные дороги для логистической компании

**Лучше выбрать графовые БД**

>генеалогические деревья

**Иерархические - древовидная структура, записи связаны друг с другом через связи в отношениях родитель-потомок**

>кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации

**Для хранения кеша лучше подходят NoSQL базы, т.к. работают быстро. Для этой цели часто используют Memcached**.

>отношения клиент-покупка для интернет-магазина

**Реляционная - отношение клиент-покупка удобно хранить в виде отдельных таблиц связанных между собой, таблица клиентов-> таблица покупок, заказов**.

*Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор*.

***

## Задание 2

*Вы создали распределённое высоконагруженное приложение и хотите классифицировать его согласно CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если (каждый пункт — это отдельная реализация вашей системы и для каждого пункта нужно привести классификацию)*:

>данные записываются на все узлы с задержкой до часа (асинхронная запись);
 
**По классификации CAP - PA - удовлетворяет доступности и разделению, но не удовлетворяет согласованности данных в единицу времени. По классификаиции PACELC это будет PA/EC- удовлетворяет разделению и доступности, фокусируется на скорости ответа и доступности, отводя консистентность на второй план**.

>при сетевых сбоях система может разделиться на 2 раздельных кластера;

**PA - удовлетворяет доступности и устойчива к разделению системы, консистентность данных в двух кластерах зависит от реализации и принятых ограничениях и не гарантируется. PA/EL - удовлетворяет требованиям высокой доступности при разделении, высокая скорость ответа ставится на второй план**.

>система может не прислать корректный ответ или сбросить соединение

**Это CP согласно теореме CAP, потомучто не выполняется условие доступности. По PACELC это PC/EC**.

*Согласно PACELC-теореме как бы вы классифицировали эти реализации?*

***

## Задание 3

*Могут ли в одной системе сочетаться принципы BASE и ACID? Почему*?

**Принципы BASE и ACID в одной системе сочетаться не могут, т.к. эти принципы противоречат друг другу**.
 + **ACID говорит о том, что транзакции атомарны, согласованны, изолированны и стойки к низкоуровнемым проблемам, гарантируя надежность и предсказуемость работы системы**

   - **A - atomicity (атомарность) никакая транзакция не будет зафиксирована в БД частично**.
   - **C - consistency (согласованность) каждая успешная транзакция фиксирует только допустимые результаты**.
   - **I - isolation (изоляция) параллельные транзакции не искажают результат друг друга**.
   - **D - durability (стойкость) гарантия применения успешных транзакций, независимо от низкоуровневых проблем. ACID позволяет проектировать высоконадежные системы**.

 + **BASE гарантирует только базовую доступность и только в конечном итоге даёт согласованность данных, позволяя создавать высокопроизводительные системы**

   - **BA - basically availability (базовая доступность) деградация части узлов ведет к деградации части сессий, исключая полную деградацию системы. Система отвечает на любой запрос, но в ответе могут быть неверные данные**.
   - **S - soft state (неустойчивое состояние) уменьшение времени хранения сессий и фиксация обновлений только критичных операций**.
   - **E - eventually consistent (конечная согласованность) изменение состояния в конечном итоге применится на все системы BASE позволяет проектировать высокопроизводительные системы**.

***

## Задание 4

*Вам дали задачу написать системное решение, основой которого бы послужили*:

 + фиксация некоторых значений с временем жизни
 + реакция на истечение таймаута

*Вы слышали о key-value-хранилище, которое имеет механизм Pub/Sub. Что это за система? Какие минусы выбора этой системы*?

**Наиболее подходящим решением в данной ситуации будет Redis. Redis это key-value хранилище, которое хорошо реализует классический pub-sub и показывает замечательную производительность**.

**минусы Redis**:
 + **При сбоях и проблемах с эл. питанием будут потеряны данные которые не успели записаться на диск. Частая запись на диск может привести к низкой производительности и снизить ресурс диска. [Ссылка](https://redis.io/docs/management/persistence/)**
 + **По поводу механизма pub/sub: Redis использует доставку сообщений не больше одного, как предполагает название - это означает, что сообщение будет доставлено 1 раз, если вообще будет доставлено. Если сообщение было уже отправлено Redis, оно не будет отправлено повторно. Если подписчик не может получить сообщение, например, из-за ошибки или отключения сети, то сообщение потеряно навсегда.**
 + **Кластер Redis не гарантирует строгой согласованности. На практике это означает, что при определенных условиях возможно, что кластер Redis потеряет записи, которые были подтверждены системой клиенту.[Ссылка](https://redis.io/docs/management/scaling/)**.
 + **Нет поддержки отката транзакций в угоду производительности.[Ссылка](https://redis.io/docs/manual/transactions/)**.
